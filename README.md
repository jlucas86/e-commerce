functial form base auth with CSRF with BREACH protection